<div class="modal fade" id="addItemModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Добавить продукт</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addItemForm">
                    <div class="mb-3">
                        <label for="name" class="form-label">Название</label>
                        <input type="text" class="form-control" id="name" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label for="production_cost" class="form-label">Себестоимость</label>
                        <input type="number" step="0.01" class="form-control" id="production_cost" name="production_cost" required>
                    </div>
                    <div class="mb-3">
                        <label for="quantity_storaged" class="form-label">Количество на складе</label>
                        <input type="number" class="form-control" id="quantity_storaged" name="quantity_storaged" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                <button type="button" class="btn btn-primary" id="saveItem">Сохранить</button>
            </div>
        </div>
    </div>
</div>

{# Table Container #}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Управление продуктами</h2>
    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addItemModal">
        <i class="fas fa-plus"></i> Добавить продукт
    </button>
</div>

<div class="table-container" data-table-config='{
    "table_name": "admin_view_products",
    "columns": [
        {
            "field": "name",
            "label": "Название",
            "sortable": true,
            "editable": true,
            "type": "text"
        },
        {
            "field": "production_cost",
            "label": "Себестоимость",
            "sortable": true,
            "editable": true,
            "type": "number"
        },
        {
            "field": "quantity_storaged",
            "label": "Количество на складе",
            "sortable": true,
            "editable": true,
            "type": "number"
        }
    ],
    "actions": [
        {
            "name": "delete",
            "icon": "trash",
            "type": "danger"
        }
    ],
    "search_endpoint": "/api/admin_view_products/search",
    "pagination": {
        "current_page": {{ current_page|default(1) }},
        "total_pages": {{ total_pages|default(1) }}
    },
    "items": {{ products|json_encode|raw }},
    "apiEndpoint": "/api",
    "addModalId": "addItemModal",
    "addFormId": "addItemForm",
    "addButtonId": "saveItem"
}'>
    {# Search Section #}
    <div class="search-section mb-3">
        <div class="input-group">
            <input type="text" class="form-control search-input" placeholder="Поиск..." data-endpoint="/api/admin_view_products/search">
            <button class="btn btn-outline-secondary" type="button">
                <i class="fas fa-search"></i>
            </button>
        </div>
        <div class="search-results d-none"></div>
    </div>

    {# Table #}
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th class="sortable" data-field="name" data-order="asc">
                        Название
                        <i class="fas fa-sort"></i>
                    </th>
                    <th class="sortable" data-field="production_cost" data-order="asc">
                        Себестоимость
                        <i class="fas fa-sort"></i>
                    </th>
                    <th class="sortable" data-field="quantity_storaged" data-order="asc">
                        Количество на складе
                        <i class="fas fa-sort"></i>
                    </th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody>
                {% for product in products %}
                    <tr data-id="{{ product.id }}">
                        <td class="editable" data-field="name" data-type="text" data-original-value="{{ product.name }}">{{ product.name }}</td>
                        <td class="editable" data-field="production_cost" data-type="number" data-original-value="{{ product.productionCost }}">{{ product.productionCost }}</td>
                        <td class="editable" data-field="quantity_storaged" data-type="number" data-original-value="{{ product.quantityStoraged }}">{{ product.quantityStoraged }}</td>
                        <td>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-danger" data-action="delete" data-id="{{ product.id }}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    {# Pagination #}
    {% if total_pages > 1 %}
        <nav aria-label="Page navigation" class="mt-3">
            <ul class="pagination justify-content-center">
                {% if current_page > 1 %}
                    <li class="page-item">
                        <a class="page-link" href="#" data-page="{{ current_page - 1 }}">Предыдущая</a>
                    </li>
                {% endif %}

                {% for i in 1..total_pages %}
                    <li class="page-item {% if i == current_page %}active{% endif %}">
                        <a class="page-link" href="#" data-page="{{ i }}">{{ i }}</a>
                    </li>
                {% endfor %}

                {% if current_page < total_pages %}
                    <li class="page-item">
                        <a class="page-link" href="#" data-page="{{ current_page + 1 }}">Следующая</a>
                    </li>
                {% endif %}
            </ul>
        </nav>
    {% endif %}
</div> 