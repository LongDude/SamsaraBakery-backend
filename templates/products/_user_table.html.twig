{% import "components/table/_base.html.twig" as base_table %}

{% set config = {
        'columns': [
            {
                'field': 'name',
                'label': 'Название',
                'sortable': true,
                'editable': false,
                'type': 'text'
            },
            {
                'field': 'quantityStoraged',
                'label': 'Количество',
                'sortable': true,
                'editable': false,
                'type': 'number'
            }
        ],
        'actions': [],
        'searchFields': ['name'],
        'search_endpoint': '/api/user_view_products/search',
        'pagination': {
            'current_page': current_page|default(1),
            'total_pages': total_pages|default(1)
        },
        'items': products,
        'tableType': 'user_view_products',
        'apiEndpoint': '/api'
} %}

{{ base_table.render_table(config) }}

{# Инициализация TableManager #}
<script>
document.addEventListener('DOMContentLoaded', () => {
    const tableConfig = {
        tableType: 'user_view_products',
        apiEndpoint: '/api',
        searchEndpoint: '{{ config.search_endpoint }}',
        searchFields: {{ config.searchFields|json_encode|raw }},
        searchDelay: 300,
        columns: {{ config.columns|json_encode|raw }},
        actions: {{ config.actions|json_encode|raw }},
        pagination: {{ config.pagination|json_encode|raw }}
    };

    const tableManager = new TableManager(tableConfig);
    tableManager.initializeTableHandlers();
});
</script> 